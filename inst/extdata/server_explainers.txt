output$CeterisParibus%1$s <- renderPlot({ 
  
  pred_cp <- ingredients::ceteris_paribus(explainer, new_observation = observation())
  p <- plot(pred_cp) +
    ingredients::show_observations(pred_cp)
  
  return(p)
})


output$BreakDown%1$s <- renderPlot({ 
  
  pred_bd <- iBreakDown::local_attributions(explainer, new_observation = observation())
  p <- plot(pred_bd) 
  
  return(p)
})

output$LocalModel%1$s <- renderPlot({ 
  
  pred_localModel <- localModel::individual_surrogate_model(explainer,
                                                            new_observation = observation(),
                                                            size = 500)
  p <- plot(pred_localModel) +
    DALEX::theme_drwhy()
  
  return(p)
})


output$Shapley%1$s <- renderPlot({
  
  shapley%1$s <- Shapley$new(predictor, x.interest = observation())
  p <- shapley$plot() +
    DALEX::theme_drwhy()
  
  return(p)
})


lime.explain <- reactive({
  LocalModel$new(predictor,
                 x.interest = observation(),
                 k = input$lime_n_vars)
})

output$Lime%1$s <- renderPlot({
  p <- plot(lime.explain())+
    DALEX::theme_drwhy()
  return(p)
})

output$shapeR%1$s <- renderPlot({
  shaper <- shapper::individual_variable_effect(explainer$model, data = explainer$data[, -1],
                                                new_observation = observation())
  
  plot(shaper)
})